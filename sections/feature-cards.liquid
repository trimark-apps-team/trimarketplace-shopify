<div class="icon-feature-grid" id="section-{{ section.id }}">
  <div class="page-width">
    <div class="grid-wrapper" style="display: grid;">
      {% for block in section.blocks %}
        {%- case block.type -%}
          {%- when 'feature' -%}
            <div class="feature-card">
              {% if block.settings.icon != blank %}
                <div class="feature-heading">
                  <img src="{{ block.settings.icon | img_url: '64x64' }}" alt="" class="feature-icon">
                  {{ block.settings.heading }}
                </div>
              {% endif %}
              <div class="feature-description" >
                {{ block.settings.description }}
              </div>
              {% if block.settings.link_label != blank and block.settings.link_url != blank %}
                <a href="{{ block.settings.link_url }}" class="feature-card-link">
                  {{ block.settings.link_label }}
                  <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                  </svg>
                </a>
              {% endif %}
            </div>
          {%- when 'logo' -%}
            <div class="feature-card feature-logo">
              {% if block.settings.logo != blank %}
                  {% if customer.current_company.metafields.custom.company_logo != blank %}
                    <img src="{{ customer.current_company.metafields.custom.company_logo | img_url: '243x81' }}" alt="" class="feature-logo">
                  {% else %}
                  <img src="{{ block.settings.logo | img_url: '243x81' }}" alt="" class="feature-logo">
                    {% endif %}
                  {{ block.settings.heading }}

              {% endif %}
            </div>
            {%- when 'sales-contact-block' -%}
            <div class="feature-card sales-contact_details">
               <p><b>{{ block.settings.heading-1 }}: </b>{{ customer.current_company.metafields.custom.company_sales_contact_details.value.name }}</p>
               <p><b>{{ block.settings.heading-2 }}: </b><a href="tel:{{ customer.current_company.metafields.custom.company_sales_contact_details.value.phone }}">{{ customer.current_company.metafields.custom.company_sales_contact_details.value.phone }}</a></p>
               <p><b>{{ block.settings.heading-3 }}: </b><a href="mailto:{{ customer.current_company.metafields.custom.company_sales_contact_details.value.email }}">{{ customer.current_company.metafields.custom.company_sales_contact_details.value.email }}</a></p>
               <p><b>{{ block.settings.heading-4 }}: </b>{{ customer.current_company.metafields.custom.company_sales_contact_details.value.address }}</p>
            </div>
        {%- endcase -%}
      {% endfor %}
    </div>
  </div>
</div>

<style>
#section-{{ section.id }} {
  margin-top: {{ section.settings.margin_top }}px;
  margin-bottom: {{ section.settings.margin_bottom }}px;
}
#section-{{ section.id }} .feature-heading {
  color: {{ section.settings.heading_color }}; 
  font-size: {{ section.settings.heading_font_size }}px;
  border-bottom: 1px solid #e0e0e1;
  width: 100%;
  padding: 10px 0px;
}
#section-{{ section.id }} .feature-description {
  color: {{ section.settings.text_color }}; 
  font-size: {{ section.settings.text_font_size }}px;
  min-height: 60px;
}
.sales-contact_details p {
  color: {{ section.settings.text_color }}; 
  font-size: {{ section.settings.text_font_size }}px;
}
.sales-contact_details a {
  color: {{ section.settings.view_all_color }}; 
}
#section-{{ section.id }} .feature-card-link {
  color: {{ section.settings.view_all_color }}; 
  font-size: {{ section.settings.view_all_font_size }}px;
}
#section-{{ section.id }} .feature-logo {
  align-content: center;
  text-align: center;
}
@media screen and (max-width: 749px) {
  #section-{{ section.id }} {
    margin-top: {{ section.settings.margin_top_mobile }}px;
    margin-bottom: {{ section.settings.margin_bottom_mobile }}px;
  }
  #section-{{ section.id }} .feature-heading {
    color: {{ section.settings.header_color_mobile }}; 
    font-size: {{ section.settings.header_font_size_mobile }}px;
    border-bottom: 1px solid #e0e0e1;
    width: 100%;
    padding: 10px 0px;
  }
  #section-{{ section.id }} .feature-description, .sales-contact_details p {
    color: {{ section.settings.text_color_mobile }}; 
    font-size: {{ section.settings.text_font_size_mobile }}px;
  }
  #section-{{ section.id }} .feature-card-link{
    color: {{ section.settings.view_all_color_mobile }}; 
    font-size: {{ section.settings.view_all_font_size_mobile }}px;
  }
  #section-{{ section.id }} .grid-wrapper {
    grid-template-columns: repeat(1, 1fr) !important;
  }
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function(){
  var section = document.getElementById("section-{{ section.id }}");
  if(section){
    var grid = section.querySelector(".grid-wrapper");
    var blocks = grid.querySelectorAll(".feature-card").length;
    if(blocks === 1){
      grid.style.gridTemplateColumns = "1fr";
    } else if(blocks === 2){
      grid.style.gridTemplateColumns = "repeat(2, 1fr)";
    } else if(blocks === 3){
      grid.style.gridTemplateColumns = "repeat(3, 1fr)";
    } else {
      grid.style.gridTemplateColumns = "repeat(4, 1fr)";
    }
  }
});
</script>

{% schema %}
{
  "name": "Feature Card Grid",
  "settings": [
    { "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "label": "Heading Font Size (px)",
      "min": 12,
      "max": 48,
      "default": 20
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "text_font_size",
      "label": "Text Font Size (px)",
      "min": 12,
      "max": 24,
      "default": 16
    },
    { 
      "type": "range",
      "id": "margin_top", 
      "label": "Top Gap", 
      "default": 18, 
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "range", 
      "id": "margin_bottom", 
      "label": "Bottom Gap", 
      "default": 18, 
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "color", 
      "id": "view_all_color", 
      "label": "View all Color", 
      "default": "#b11830" 
    },
    { 
      "type": "range", 
      "id": "view_all_font_size", 
      "label": "View all Font Size", 
      "default": 18, 
      "min": 12, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "header", 
      "content": "Mobile Settings" 
    },
    { 
      "type": "color", 
      "id": "header_color_mobile", 
      "label": "Header Color Mobile", 
      "default": "#b11830" 
    },
    { 
      "type": "range", 
      "id": "header_font_size_mobile", 
      "label": "Header Font Size Mobile", 
      "default": 18, 
      "min": 12, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "color", 
      "id": "text_color_mobile", 
      "label": "Text Color Mobile", 
      "default": "#b11830" 
    },
    { 
      "type": "range", 
      "id": "text_font_size_mobile", 
      "label": "Text Font Size Mobile", 
      "default": 18, 
      "min": 12, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "range", 
      "id": "margin_top_mobile", 
      "label": "Top Gap Mobile", 
      "default": 18, 
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "range", 
      "id": "margin_bottom_mobile", 
      "label": "Bottom Gap Mobile", 
      "default": 18, 
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    },
    { 
      "type": "color", 
      "id": "view_all_color_mobile", 
      "label": "View all Color Mobile", 
      "default": "#b11830" 
    },
    { 
      "type": "range", 
      "id": "view_all_font_size_mobile", 
      "label": "View all Font Mobile", 
      "default": 18, 
      "min": 12, 
      "max": 100, 
      "step": 1, 
      "unit": "px" 
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "Link Label",
          "default": "View All"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL"
        }
      ]
    },
    {
      "type": "logo",
      "name": "Logo",
      "settings": [
        {
          "type": "image_picker",
          "id": "logo",
          "label": "Logo"
        }
      ]
    },
    {
      "type": "sales-contact-block",
      "name": "Sales contact block",
      "settings": [
        {
          "type": "text",
          "id": "heading-1",
          "label": "Heading 1",
          "default": "Sales Contact"
        },
        {
          "type": "text",
          "id": "heading-2",
          "label": "Heading 2",
          "default": "Phone"
        },
        {
          "type": "text",
          "id": "heading-3",
          "label": "Heading 3",
          "default": "Email"
        },
        {
          "type": "text",
          "id": "heading-4",
          "label": "Heading 4",
          "default": "Address"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Feature Card Grid",
      "blocks": [
        { "type": "feature" },
        { "type": "feature" }
      ]
    }
  ]
}
{% endschema %}