<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic@VERSION/dist/theme.min.css">



<script defer>
document.addEventListener('DOMContentLoaded', function () {
  const { algoliasearch, autocomplete, getAlgoliaResults } = algoliaShopify.externals;

  const searchClient = algoliaShopify.searchClient; // already initialized with your app ID & key
  const indexName = `${algoliaShopify.config.index_prefix}products`; // reuse their prefix

  autocomplete({
    container: '#autocomplete-container',
    placeholder: 'Search products...',
    openOnFocus: true,
    getSources({ query }) {
      return [
        {
          sourceId: 'products',
          getItems() {
            return getAlgoliaResults({
              searchClient,
              queries: [
                {
                  indexName,
                  params: {
                    query,
                    hitsPerPage: 5,
                  },
                },
              ],
            });
          },
          templates: {
            item({ item }) {
              return `
                <div style="padding:8px 0;">
                  <strong>${item.title || item.name}</strong><br>
                  <small>${item.handle || ''}</small>
                </div>`;
            },
            noResults() {
              return 'No results found';
            },
          },
        },
      ];
    },
  });
});
</script>